---
// Impact Statistics Section with animated counters
---

<section
  id="impact-stats"
  class="py-20 px-4 md:px-8 max-w-7xl mx-auto relative overflow-hidden"
>
  <!-- Background gradient effects -->
  <div class="absolute inset-0 bg-gradient-to-b from-neutral-950 via-neutral-900 to-neutral-950 -z-10"></div>
  <div class="absolute inset-0 bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-purple-900/20 via-transparent to-transparent -z-10"></div>

  <!-- Section Header -->
  <div class="text-center mb-16 md:mb-20">
    <!-- Small label -->
    <p class="mono-text text-xs md:text-sm text-cyan-400 uppercase tracking-widest mb-4 font-mono">
      002 / THE STAKES
    </p>

    <!-- Main title -->
    <h2 class="text-4xl md:text-5xl lg:text-6xl xl:text-7xl font-black mb-6 tracking-tight text-white leading-tight">
      The Unsexy Numbers<br />That Matter
    </h2>

    <!-- Tagline -->
    <p class="text-neutral-400 text-lg md:text-xl max-w-3xl mx-auto leading-relaxed">
      These aren't vanity metrics. They're <span class="text-red-400 font-semibold">body counts</span> we're trying to reduce.
    </p>
  </div>

  <!-- Stats Grid -->
  <div class="stats-grid grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8">
    <!-- Stat 1: Lives Saved -->
    <div
      class="stat-card group relative p-8 rounded-2xl bg-neutral-900/50 backdrop-blur-sm border border-neutral-800 hover:border-cyan-500/50 transition-all duration-500"
      data-stat="1"
      style="border-left: 4px solid rgb(6, 182, 212);"
    >
      <!-- Glow effect -->
      <div class="absolute -inset-1 bg-gradient-to-r from-cyan-500/20 to-cyan-500/0 rounded-2xl blur-xl opacity-0 group-hover:opacity-100 transition-opacity duration-500 -z-10"></div>

      <!-- Content -->
      <div class="relative z-10">
        <!-- Number -->
        <div class="stat-number text-6xl md:text-7xl lg:text-8xl font-black text-transparent bg-clip-text bg-gradient-to-br from-cyan-400 to-cyan-600 mb-4 leading-none">
          <span class="counter" data-target="150" data-suffix="K+">0</span>
        </div>

        <!-- Label -->
        <p class="text-neutral-300 text-lg md:text-xl font-semibold mb-2">
          Lives Saved Annually
        </p>

        <!-- Description -->
        <p class="text-neutral-500 text-sm leading-relaxed">
          Through drug verification systems preventing counterfeit medications
        </p>
      </div>
    </div>

    <!-- Stat 2: People Without Internet -->
    <div
      class="stat-card group relative p-8 rounded-2xl bg-neutral-900/50 backdrop-blur-sm border border-neutral-800 hover:border-purple-500/50 transition-all duration-500"
      data-stat="2"
      style="border-left: 4px solid rgb(168, 85, 247);"
    >
      <!-- Glow effect -->
      <div class="absolute -inset-1 bg-gradient-to-r from-purple-500/20 to-purple-500/0 rounded-2xl blur-xl opacity-0 group-hover:opacity-100 transition-opacity duration-500 -z-10"></div>

      <!-- Content -->
      <div class="relative z-10">
        <!-- Number -->
        <div class="stat-number text-6xl md:text-7xl lg:text-8xl font-black text-transparent bg-clip-text bg-gradient-to-br from-purple-400 to-purple-600 mb-4 leading-none">
          <span class="counter" data-target="2.6" data-suffix="B">0</span>
        </div>

        <!-- Label -->
        <p class="text-neutral-300 text-lg md:text-xl font-semibold mb-2">
          People Without Internet
        </p>

        <!-- Description -->
        <p class="text-neutral-500 text-sm leading-relaxed">
          Still relying on basic phones and SMS for critical information
        </p>
      </div>
    </div>

    <!-- Stat 3: Crop Yield Improvement -->
    <div
      class="stat-card group relative p-8 rounded-2xl bg-neutral-900/50 backdrop-blur-sm border border-neutral-800 hover:border-orange-500/50 transition-all duration-500"
      data-stat="3"
      style="border-left: 4px solid rgb(249, 115, 22);"
    >
      <!-- Glow effect -->
      <div class="absolute -inset-1 bg-gradient-to-r from-orange-500/20 to-orange-500/0 rounded-2xl blur-xl opacity-0 group-hover:opacity-100 transition-opacity duration-500 -z-10"></div>

      <!-- Content -->
      <div class="relative z-10">
        <!-- Number -->
        <div class="stat-number text-6xl md:text-7xl lg:text-8xl font-black text-transparent bg-clip-text bg-gradient-to-br from-orange-400 to-orange-600 mb-4 leading-none">
          <span class="counter" data-target="30" data-suffix="-40%">0</span>
        </div>

        <!-- Label -->
        <p class="text-neutral-300 text-lg md:text-xl font-semibold mb-2">
          Crop Yield Improvement
        </p>

        <!-- Description -->
        <p class="text-neutral-500 text-sm leading-relaxed">
          From SMS-based weather alerts and agricultural guidance
        </p>
      </div>
    </div>

    <!-- Stat 4: Contaminated Water -->
    <div
      class="stat-card group relative p-8 rounded-2xl bg-neutral-900/50 backdrop-blur-sm border border-neutral-800 hover:border-pink-500/50 transition-all duration-500"
      data-stat="4"
      style="border-left: 4px solid rgb(236, 72, 153);"
    >
      <!-- Glow effect -->
      <div class="absolute -inset-1 bg-gradient-to-r from-pink-500/20 to-pink-500/0 rounded-2xl blur-xl opacity-0 group-hover:opacity-100 transition-opacity duration-500 -z-10"></div>

      <!-- Content -->
      <div class="relative z-10">
        <!-- Number -->
        <div class="stat-number text-6xl md:text-7xl lg:text-8xl font-black text-transparent bg-clip-text bg-gradient-to-br from-pink-400 to-pink-600 mb-4 leading-none">
          <span class="counter" data-target="1.8" data-suffix="B">0</span>
        </div>

        <!-- Label -->
        <p class="text-neutral-300 text-lg md:text-xl font-semibold mb-2">
          People Drinking Contaminated Water
        </p>

        <!-- Description -->
        <p class="text-neutral-500 text-sm leading-relaxed">
          Lacking access to safe drinking water and sanitation
        </p>
      </div>
    </div>

    <!-- Stat 5: Cost Per SMS -->
    <div
      class="stat-card group relative p-8 rounded-2xl bg-neutral-900/50 backdrop-blur-sm border border-neutral-800 hover:border-green-500/50 transition-all duration-500"
      data-stat="5"
      style="border-left: 4px solid rgb(34, 197, 94);"
    >
      <!-- Glow effect -->
      <div class="absolute -inset-1 bg-gradient-to-r from-green-500/20 to-green-500/0 rounded-2xl blur-xl opacity-0 group-hover:opacity-100 transition-opacity duration-500 -z-10"></div>

      <!-- Content -->
      <div class="relative z-10">
        <!-- Number -->
        <div class="stat-number text-6xl md:text-7xl lg:text-8xl font-black text-transparent bg-clip-text bg-gradient-to-br from-green-400 to-green-600 mb-4 leading-none">
          <span class="counter" data-target="0.03" data-prefix="$" data-decimals="2">0</span>
        </div>

        <!-- Label -->
        <p class="text-neutral-300 text-lg md:text-xl font-semibold mb-2">
          Cost Per SMS Alert
        </p>

        <!-- Description -->
        <p class="text-neutral-500 text-sm leading-relaxed">
          Making life-saving information accessible at scale
        </p>
      </div>
    </div>

    <!-- Empty card for grid alignment -->
    <div class="hidden lg:block"></div>
  </div>
</section>

<style>
  .stat-card {
    opacity: 0;
    transform: translateY(50px);
  }

  .mono-text {
    letter-spacing: 0.15em;
  }

  /* Responsive stat numbers */
  @media (max-width: 640px) {
    .stat-number {
      font-size: 3.5rem;
    }
  }
</style>

<script>
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  gsap.registerPlugin(ScrollTrigger);

  document.addEventListener("DOMContentLoaded", () => {
    // Animate stat cards on scroll with stagger
    const statCards = document.querySelectorAll(".stat-card");

    statCards.forEach((card, index) => {
      gsap.to(card, {
        y: 0,
        opacity: 1,
        duration: 0.8,
        delay: index * 0.2,
        ease: "power3.out",
        scrollTrigger: {
          trigger: card,
          start: "top 85%",
          toggleActions: "play none none none",
        },
      });
    });

    // Counter animation function
    function animateCounter(element: Element) {
      const target = parseFloat(element.getAttribute("data-target") || "0");
      const prefix = element.getAttribute("data-prefix") || "";
      const suffix = element.getAttribute("data-suffix") || "";
      const decimals = parseInt(element.getAttribute("data-decimals") || "0");

      const counter = { value: 0 };

      gsap.to(counter, {
        value: target,
        duration: 2.5,
        ease: "power2.out",
        scrollTrigger: {
          trigger: element,
          start: "top 80%",
          toggleActions: "play none none none",
        },
        onUpdate: function () {
          const currentValue = counter.value;
          let displayValue: string;

          if (decimals > 0) {
            displayValue = currentValue.toFixed(decimals);
          } else if (currentValue >= 1) {
            displayValue = Math.floor(currentValue).toString();
          } else {
            displayValue = currentValue.toFixed(1);
          }

          element.textContent = prefix + displayValue + suffix;
        },
        onComplete: function () {
          // Ensure final value is exact
          let finalValue: string;
          if (decimals > 0) {
            finalValue = target.toFixed(decimals);
          } else {
            finalValue = target.toString();
          }
          element.textContent = prefix + finalValue + suffix;
        },
      });
    }

    // Animate all counters
    const counters = document.querySelectorAll(".counter");
    counters.forEach((counter) => {
      animateCounter(counter);
    });

    // Add subtle parallax effect to section header
    const header = document.querySelector("#impact-stats h2");
    if (header) {
      gsap.from(header, {
        y: 30,
        opacity: 0,
        duration: 1,
        ease: "power3.out",
        scrollTrigger: {
          trigger: header,
          start: "top 90%",
          toggleActions: "play none none none",
        },
      });
    }

    // Add hover effect enhancement
    statCards.forEach((card) => {
      const statNumber = card.querySelector(".stat-number");

      card.addEventListener("mouseenter", () => {
        gsap.to(statNumber, {
          scale: 1.05,
          duration: 0.3,
          ease: "power2.out",
        });
      });

      card.addEventListener("mouseleave", () => {
        gsap.to(statNumber, {
          scale: 1,
          duration: 0.3,
          ease: "power2.out",
        });
      });
    });
  });
</script>
